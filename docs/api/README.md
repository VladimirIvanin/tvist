# API Документация - Генерация таблицы опций

## Обзор

Таблица опций в документации генерируется автоматически на основе метаданных из файла `docs/.vitepress/options-meta.json`.

## Как это работает

1. **Исходные данные** - JSDoc комментарии в `src/core/types.ts`
2. **Метаданные** - JSON файл `docs/.vitepress/options-meta.json`
3. **Компонент** - Vue компонент `docs/.vitepress/theme/OptionsTable.vue`
4. **Страницы** - Markdown файлы используют компонент `<OptionsTable />`

## Автоматическая генерация

### Генерация метаданных

При добавлении или изменении опций в `src/core/types.ts`:

```bash
npm run docs:generate-meta
```

Скрипт парсит JSDoc комментарии из `types.ts` и обновляет JSON файл.

### Сборка документации

Метаданные автоматически генерируются при сборке:

```bash
npm run docs:build
```

## Ручное обновление

Если автоматическая генерация не работает корректно, можно вручную отредактировать `docs/.vitepress/options-meta.json`.

### Формат JSON

```json
{
  "options": [
    {
      "name": "perPage",
      "type": "number",
      "default": "1",
      "description": "Количество слайдов на странице"
    },
    {
      "name": "arrows",
      "type": "boolean | object",
      "default": "false",
      "description": "Навигационные стрелки",
      "nested": [
        {
          "name": "prev",
          "type": "string | HTMLElement",
          "description": "Селектор для кнопки назад"
        }
      ]
    }
  ]
}
```

### Поля опции

- `name` - название опции (обязательно)
- `type` - тип данных (обязательно)
- `default` - значение по умолчанию (обязательно)
- `description` - описание опции (обязательно)
- `nested` - вложенные свойства для объектов (опционально)

## Использование в документации

В любом Markdown файле можно использовать:

```markdown
# Опции

<OptionsTable />
```

## Обновление TypeScript типов

При добавлении новых опций в `src/core/types.ts`:

1. Добавьте JSDoc комментарий с описанием и `@default` значением:

```typescript
/**
 * Описание опции
 * @default значение_по_умолчанию
 */
optionName?: type
```

2. Запустите генерацию метаданных:

```bash
npm run docs:generate-meta
```

3. Проверьте результат в dev режиме:

```bash
npm run docs:dev
```

## Функции таблицы

Компонент `OptionsTable` предоставляет:

- **Поиск** - поиск по названию, типу и описанию
- **Раскрытие вложенных** - клик на опции с вложенными свойствами
- **Автораскрытие при поиске** - вложенные свойства раскрываются если найдено совпадение
- **Адаптивность** - оптимизация для мобильных устройств

## Разработка

### Локальная разработка

```bash
npm run docs:dev
```

### Сборка продакшен

```bash
npm run docs:build
npm run docs:preview
```

## Устранение проблем

### Опция не отображается

1. Проверьте наличие JSDoc комментария в `types.ts`
2. Проверьте формат комментария (должен содержать `@default`)
3. Перегенерируйте метаданные: `npm run docs:generate-meta`
4. Проверьте `options-meta.json` на корректность JSON

### Неправильное описание

1. Откройте `docs/.vitepress/options-meta.json`
2. Найдите опцию и исправьте поля вручную
3. Или исправьте JSDoc в `types.ts` и перегенерируйте

### Вложенные свойства не парсятся

Текущая версия парсера может некорректно обрабатывать сложные вложенные типы. 
В этом случае рекомендуется ручное редактирование JSON файла.
